# Fail2Ban jail configuration files
#
# These jails come in addition the default jails offered by fail2ban.
#


# The fact that a computer attempts to connect to use via port 23 is a
# very clear signal that we do not want that IP to ever access us in
# any other way either.
#
[snap-telnet]
enabled  = true
filter   = snap-telnet-filter
action   = snap-firewall-action[scheme=all,period=forever,reason=fail2ban: telnet]
logpath  = /var/log/iptables.log
maxretry = 1
findtime = 86400

# The snap-iptables scans the /var/log/iptables.log which is a set of
# kernel log as coming from LOG rules in the iptables firewall.
#
# If the same IP address tried to access our services for 5 times or
# more and got blocked within the last 1h, block the IP for a year.
#
[snap-iptables]
enabled  = true
filter   = snap-iptables-filter
action   = snap-firewall-action[scheme=all,period=year,reason=fail2ban: iptables]
logpath  = /var/log/iptables.log
maxretry = 5
findtime = 3600

[snap-apache-badrequest]
enabled  = true
filter   = snap-apache-badrequest-filter
action   = snap-firewall-action[scheme=all,period=year,reason=fail2ban: apache bad request]
logpath  = %(apache_access_log)s
maxretry = 1
findtime = 86400

[snap-apache-proxy]
enabled  = true
filter   = snap-apache-proxy-filter
action   = snap-firewall-action[scheme=all,period=year,reason=fail2ban: apache proxy]
logpath  = %(apache_access_log)s
maxretry = 1
findtime = 86400

[snap-apache-timeout]
enabled  = true
filter   = snap-apache-timeout-filter
action   = snap-firewall-action[scheme=all,period=year,reason=fail2ban: apache timeout]
logpath  = %(apache_access_log)s
# This can happen to regular users if they lose their Internet connection
# and they could have quite a few connections (especially with Chrome)
maxretry = 35
findtime = 3600

[snap-apache-unwanted]
enabled  = true
filter   = snap-apache-unwanted-filter
action   = snap-firewall-action[scheme=all,period=year,reason=fail2ban: apache unwanted]
logpath  = %(apache_access_log)s
maxretry = 1
findtime = 86400

# vim: syntax=dosini
