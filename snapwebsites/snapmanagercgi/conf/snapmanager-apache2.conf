#
#                  PLEASE DO NOT EDIT!
#
# The following is a default, read-only, apache2 configuration coming with Snap!
#
# For details, please read this README.md file:
#
#     /etc/apache2/snap-conf/README.md
#


# Force all connections to snapmanager.cgi to use SSL by default
#
# This feature requires the "alias" module (RedirectMatch) which you can
# turn on with (note: it is on by default):
#
#      sudo a2enmod alias
#
<VirtualHost *:80>
  # Retrieve the user definitions
  #
  Include /etc/apache2/snap-conf/snapmanager/snapmanager-apache2-common.conf
  # definitions after the user definitions overwrite whatever the user
  # may have entered...

  DocumentRoot /var/www/snapmanager/public_html

  ErrorLog /var/log/apache2/snapmanager-error.log
  CustomLog /var/log/apache2/snapmanager-access.log vhost_combined

  # Permanently redirect to port 443 with an HTTP 301 code
  #
  RewriteEngine on
  RewriteRule ^(.*)/$ https://%{HTTP_HOST}/$1 [last,qsappend,redirect=permanent]
</VirtualHost>


# Secure site (port 443 is HTTPS)
#
# We do not turn this one on by default, although you should use HTTPS
# for obvious security reasons... This is because we do not know anything
# of your SSL certificate and the setup of such varies depending on your
# SSL provider.
#
# TODO: offer a way to create a user/local certificate
#       See https://letsencrypt.org/ for example.
#
<VirtualHost *:443>
  # Retrieve the user definitions
  #
  Include /etc/apache2/snap-conf/snapmanager/snapmanager-apache2-common.conf
  Include /etc/apache2/snap-conf/snapmanager/snapmanager-apache2-443.conf
  # definitions after the user definitions overwrite whatever the user
  # may have entered...

  # We have to have a document root
  DocumentRoot /var/www/snapmanager/public_html/

  # Error and other logs
  ErrorLog /var/log/apache2/snapmanager-error.log
  CustomLog /var/log/apache2/snapmanager-access.log vhost_combined_ssl

  # Directory with snap.cgi -- update if you don't use the defaults
  #ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
  #AddHandler cgi-script .cgi
  SetEnv SNAPMANAGER TRUE

  # Do not show directory contents
  # (note that we also remove the autoindex module, but in case someone
  # was to re-enable it...)
  <Directory "/var/www/snapmanager/">
    Options -Indexes
  </Directory>

  # Now we can include our SSL options, that includes turning ON
  # the SSL engine
  #
  Include /etc/apache2/ssl-snap/snap-apache2-ssl.conf
</VirtualHost>

# vim: syntax=apache
