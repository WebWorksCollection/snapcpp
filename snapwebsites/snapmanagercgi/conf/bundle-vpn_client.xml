<?xml version="1.0"?>
<!--
  see /usr/share/snapwebsites/xsd/bundles.xsd for details
  to verify your changes (change the == with two dashes):
    xmllint ==noout ==schema /usr/share/snapwebsites/xsd/bundles.xsd /etc/snapwebsites/services.d/bundle-vpn_client.xml
-->
<bundle>
  <name>vpn_client</name>
  <description>
    <p>The OpenVPN bundle is used to secure public connections
    between computers. If you have a secure LAN then you do not
    need to install OpenVPN at all. (i.e. a secure LAN is a LAN
    that only your computers have access to.)</p>

    <p>The OpenVPN creates a network of computers to communicate
    through a safe, encrypted tunnel (Server Side) rendering a
    public LAN secure.</p>

    <p>The OpenVPN client allows this computer to connect to
    OpenVPN servers to create a safe network. Once connected
    to one or more servers, the new client can also communicate
    with other clients (client-to-client).</p>
  </description>
  <fields>
    <field name="client_conf" type="text">
      <label>VPN Client Configuration Text</label>
      <description>The OVPN file which the client uses to start openvpn. Keys and certs are included.</description>
    </field>
  </fields>
  <packages>openvpn</packages>
  <!--
    For a client, the setup is simpler: we just need to have a few
    keys and a client.conf properly setup.
  -->
  <postinst>
    # Clear out the easy-rsa dist just in case
    cd /etc/openvpn
    rm -rf *.crt *.key *.conf *.ovpn
    echo "${BUNDLE_INSTALLATION_CLIENT_CONF}" > client.ovpn

    # Start the server
    systemctl start openvpn@client
  </postinst>
  <prerm>
    systemctl stop openvpn@client
  </prerm>
</bundle>
<!--
  vim: ts=2 sw=2 et
-->
